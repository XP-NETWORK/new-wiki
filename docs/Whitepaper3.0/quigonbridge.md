---
sidebar_label: 'Quigon Bridge'
sidebar_position: 5
---

# <center>Quigon Bridge</center>

**Vision**

The NFT industry has been expanding rapidly, with weekly sales growing from $2.3 million in January 2021 to $1 billion in August, while the number of active wallets increased from 6,000 to 70,000. The process is accelerating as hundreds of NFT projects pop up on other blockchains, such as Binance Smart Chain, Solana, and Avalanche, where minting fees are far lower than on Ethereum.

However, emerging NFT communities on these alternative blockchains lack the required liquidity. Being limited to a single chain, these promising NFT projects – and NFT holders – miss out on countless opportunities.

Quigon Bridge solves this issue, allowing NFTs transfers from one blockchain to another in seconds at a minimal cost. It means wider exposure for NFT creators, better liquidity for asset holders, and increased transaction flow for the bridged blockchains.

The bridge combines high scalability with superior security. It works by creating wrapped NFTs that preserve the original assets’ metadata without duplicating the assets themselves. The original NFTs are safely stored in custody and can be restituted to the holder if needed.

**Bridging flow from the end user’s viewpoint**

Below is a short description of what the Quigon experience looks like for a regular user who wishes to send an NFT to another blockchain. 

1. The user – we will call him Bob – selects the origin chain (where his NFT currently resides – for example, BSC) from a drop-down list and the target chain where the NFT should be sent – Avalanche.

2. Bob first connects the wallet where his NFTs are stored to Quigon. The process is the same as linking a wallet to a Defi dApp.
3. The user account associated with Bob’s wallet is injected into the bridge. The bridge has a whitelisted database of NFT smart contracts, which it scans to find any NFTs that exist on Bob’s account. In more basic terms, the bridge looks for NFTs in the wallet.
4. All found by the Quigon NFT lister, NFTs are displayed in the Quigon UI (user interface). Bob can then locate the one or several NFTs he wishes to send.
5. Bob also needs to provide the recipient address on the target chain – for instance, his Avalanche-compatible wallet address.
6. The next obligatory step is ‘Approving’ NFT management by the bridge smart contract.

7. The Bridge runs the transaction in a sandbox (local node) to determine the transaction fee.

8. Then it notifies Bob of the transaction fee size and asks him to confirm that the fee should be deducted from his account via the wallet supported by the origin blockchain (in our case, BSC).

9. If Bob is satisfied with the fee, he clicks the ‘Transfer’ button and signs a request for transferring the NFT to the chosen account on Avalanche.
10. The bridge smart contract moves the NFT ownership to itself and locks the NFT in its storage. Inside the same function, it broadcasts an event to the bridge relay validators, giving them all the required information about the locked NFT and the account it should be sent to.

11. Once the fee has been paid, the validator signs the transfer transaction. This transaction is a tiny file containing the following instructions:
- which NFT should be transferred;
- to which account on the target blockchain;
- transaction fee to be paid to the target chain.
- Link to the original metadata & the asset associated with the NFT

12. At least ⅔ +1 of the validators must sign the transaction. The QuiChain collects these signatures. Once the required majority has been reached, the QuiChain notifies the target smart contract which mints a wrapped NFT. This new NFT points to the original NFT and has the same metadata, plus the three new fields:
- The chain the NFT originates from
- The address of the smart contract on the original chain
- The ID of the NFT in the original smart contract.

13. The wrapped NFT is sent to the recipient account on Avalanche, while the original NFT goes into custody, where it will be stored until (or in case if) the current owner decides to transfer the NFT back to the original chain. In this case the wrapped NFT will be burned on Avalanche, and the original will be released to s designated account on BSC.

14. If an error occurs along the way, the NFT will be returned to Bob’s account on the original blockchain (BSC).

**Wrapped NFTs and NFT custody**

When a non-fungible asset is sent through the bridge, the NFT on the original chain doesn’t disappear; rather, it goes into custody in the bridge smart contract. Suppose the holder eventually decides to transfer the NFT back where it came from. In that case, the original NFT will be extracted from the custody wallet and restituted to the user’s account. At the same time, the NFT that was generated by the bridge on the target chain will become inaccessible (which is the closest equivalent of destroying an asset that exists on the blockchain). 

Wrapping blockchain assets became popular with the spread of Defi, as users wished to use their BTC to earn money with Defi lending and trading. Since Bitcoin is incompatible with Ethereum-based Defi protocols, the best solution was to issue an Ethereum equivalent of BTC: wBTC, or wrapped Bitcoin. The mechanics are similar to Quigon: users deposit BTC in custody and receive wBTC in return. Once they are done with their Defi activities, they can return the wBTC (‘destroyed’) and claim the original Bitcoins from the custodian, which charges a fee for this service. 


With over $770M in value locked as of October 1, 2021, the popular Ren protocol works the same way. RenVM takes custody of non-Ethereum assets (be in BTC, ZEC, BCH) and issues renBTC, renZEC, etc. 

Wrapping NFTs isn’t a completely new concept, either, though so far, it has been limited to wrapping non-fungibles into regular ERC-20 tokens that represent the floor value of an NFT collection (the minimum price at which regular NFTs from a collection sell at a given moment). Thus, there is WCK, or Wrapped Kitties (for CryptoKitties) and PUNKS for CryptoPunks. 

As for wrapping NFTs into new NFTs on a different blockchain, so far, there are very few projects offering this functionality (see ‘Competition’). None of them support as many chains as Quigon, and in many cases, Quigon is the absolute first to offer an NFT bridge for a certain pair of blockchains. 

**Definition**

Quigon Bridge is a *mirror state mutation protocol* for *heterogeneous distributed ledgers*.

Blockchains the bridge connects are *state machines*. The bridge is a *protocol* (set of strict rules) regulating how the states of the connected ledgers should *mutate* (change). Mirror stands for the reflective nature of the state mutations. If an asset disappears from one ledger, it must appear in the same quantity with the same properties on the other. The ledgers are *heterogeneous* because they base on different programming languages and programming paradigms. They support different smart contract languages and token standards. 

**Composition**

Quigon Bridge comprises the following components:
- Token standard smart contracts
- Bridge smart contracts
- Relay validators
- Full nodes of the bridged chains
- JavaScript API library
- NFT lister service
- Bridge heartbeat service 
- Exchange rate service
- Fee estimation service
- Transaction Socket
- User Interface


**Supported Token Protocols**

Quigon bridge adapts and translates one token standard into another while transferring assets between heterogeneous ledgers. Here’s the list of supported standards and smart contract languages valid when writing the present paper. 

|Supported by the blockchains|Standards|Smart Contract Language|
|:-----:|:----:|:-----:|
| Ethereum, Phantom, Avalanche, xDai, Fantom, Fuse, Harmony, Celo|ERC-20, ERC-721, ERC-1155| Solidity|
|BSC| EP-20, BEP-721, BEP-1155| Solidity|
|Solana|SPL-Token| Rust|
|Elrond| ESDT| Rust|
|Tron|TRC-20, TRC-721, TRC-1155|Solidity|
|Algorand|ASA, ASA3| SmartPy (Michelson)|
|Tezos| FA1, FA2| PyTeal (TEAL)|

Quigon Bridge is a work in progress. The bridge will support more token standards while connecting chains with unique protocols. 

**The Bridge Protocol**

In 1943, Warren McCulloch and Walter Pitts published a fundamental paper on state machines (SMs).  SMs are abstract devices that are always in one (and only one) out of a set number of stable states, depending on their previous state and the inputs they receive. The paper describes several types of such finite-state machines:

- **Acceptors** can either accept input or not
- **Recognizers** can recognize an input or not
- **Transducers** can generate output from a given input

The concept of finite-state machines applies to the Quigon Bridge Relay Validators:

- A validator has a finite set of states S = {s1 … ss} - [idle, handling an event, paused, signing a transaction, reverting a transaction]
- There is a finite set of inputs that a validator can receive: either events broadcast by the smart contracts or results of computations (inputs I = {i1 … iJ})
- There is also a finite set of output symbols O = {o1 … oo} - [none, signature, smart contract address, +/- Validator credentials]
- States and inputs are mapped onto the so-called state transition function to determine the next state: I x S → S’
- Inputs and states are also mapped onto the output function to determine the output: I x S -> O

The table below synthesizes all the possible combinations of validator states, inputs, outputs, and resulting states. Each combination corresponds to state machine types: acceptor, recognizer, or transducer. 

|Current State (S<sub>x</sub>)|Input (I<sub>x</sub>)|Output (O<sub>x</sub>)|Next State (S’)|
|:--:|:--:|:--:|:--:|
|Validator as a Recognizer|
|Idle <sub>(listening)</sub>|Unrecognized event|none|Idle <sub>(listening)</sub>|
|Idle <sub>(listening)</sub>|Recognized event|none|HandleEvent|
|Validator as a Transducer|
|HandleEvent|TransferUnique|none|SignTransaction|
|HandleEvent|UnfreezeUnique|none|SignTransaction|
|HandleEvent|WhitelistNft|+1 SC address|Idle <sub>(listening)</sub>|
|HandleEvent|Pause|none|Paused|
|Paused|UnpauseBridge|none|Idle <sub>(listening)</sub>|
|HandleEvent|AddValidator|+1 Validator|Idle <sub>(listening)</sub>|
|HandleEvent|RemoveValidator|-1 Validator|Idle <sub>(listening)</sub>|
|SignTransaction|Success|signed TX|Idle <sub>(listening)</sub>|
|SignTransaction|Error|none|RevertTransaction|
|RevertTransaction|none|signed TX|Idle <sub>(listening)</sub>|

**Bridge Security**

NIST framework
While developing the security protocols for the Quigon bridge, we have used NISTIR 8286A (2nd draft) - the Interagency Report 8286A, entitled ‘Identifying and Estimating Cybersecurity Risk for Enterprise Risk Management (ERM)’, by the US National Institute of Standards and Technology. 

Apart from the report, we’ve aligned the cyber security risk management (CSRM) features of the NFT bridge with the NIST framework v1.1. The core of the framework is the five functions: Identify, Protect, Detect, Respond, and Recover. For each of these functions, there is a set of outcome categories – things that an organization has to do to keep its systems and users safe.

The following table summarizes how the NIST framework applies to the Quigon bridge infrastructure:

|Functions|Implementation|Categories|
|:--:|:--|:--|
|Identify|Understand the impact of cyber security risks on the bridge, its users and their assets (NFTs)|Bridge Systems<br></br>Users & Team<br></br>Assets (NFTs)|
|Protect|Safeguard persistent bridge functionality by limiting or containing the impact of potential security events|Employee Identity management,<br></br>Awareness & Training (users, employees),<br></br>KYC Data Security,<br></br>Bridge Maintenance in the working state|
|Detect|Timely detect cybersecurity events by continuous monitoring|SCs / Validators’ Anomalies<br></br>Detecting Cyber Security Events|
|Respond|Stopping, limiting or containing potential or ongoing incidents|Incident response planning<br></br>Incident mitigation roadmaps|
|Recover|Restore the capabilities impacted by an event|Backing up and recovery<br></br>Hardening and resilience improvements|

**Layers of Security**

Since risks can originate from multiple sources, we have implemented a layered security system where a potential penetration through one of the layers, instead of allowing the adversary to exploit a hypothetical vulnerability, exposes their ‘footprints’ to the internal security wardens. Meanwhile, the attacker runs into subsequent layers of protection that are even harder to penetrate.


**Smart Contracts Audit**

Due to the different nature of the bridge components, the means of their protection vary. As discussed earlier, the bridge consists of on-chain smart contracts, which are publicly available (and whose binary code can in many cases be restored to a human-readable form), and off-chain relay validators, responsible for mirroring the state of the source chain to the chosen target chain.

A smart contract requires proper code review, penetration testing, and audit before deploying to the blockchain. Once a contract goes live, any bugs or vulnerabilities cannot be fixed: the only remedy is to redeploy the contract from scratch. 

Even the most popular smart contracts can contain vulnerabilities and get exploited; LarvaLabs’ famous CryptoPunk NFTs are a good example. As part of a community loyalty campaign, every user who had a CryptoPunk could mint one random Meebit (a new type of digital character) for free. There was a small chance that the resulting Meebit would turn out to have rare features and thus would be very expensive. A user under the name 0xNietzsche found a way to exploit the  contract and minted Meebits repeatedly with the same CryptoPunk until he obtained a rare Meebit,  which he immediately sold for ETH 200, having spent only ETH 5 on transaction fees.

To avoid such mishaps, all Quigon smart contracts undergo meticulous testing before deployment, including penetration testing and code audit by the industry’s acknowledged security companies. Apart from verifying that there are no bugs and vulnerabilities, the audit confirms the integrity of the contract’s binary code and in the way data associated with it moves between accounts.

**Validator penetration testing**

Off-chain relay validators are more complex than smart contracts because they are composed of multiple parts on different physical or virtual machines. The first layer of security we apply to validators are the classic cyber security protocols that protect validators from physical access and human error.

Another preventive measure is validator penetration testing. It simulates attacks by black-hat (malicious) hackers, from professionals equipped with sophisticated hardware and software to young coding prodigies who may accidentally discover a contract vulnerability and exploit it, resulting in asset theft or reputational damage. 

**Elliptic-curve cryptography and digital signatures**
Asymmetric cryptography is the cornerstone of modern cyber security. Initially, only governments had access to such tools. But in 1970, a pioneering paper entitled ‘New Directions in Cryptography’ (by Martin Hellman, Whitfield Diffie, and Ralph Merkle) opened up the possibilities of public-key cryptography to the wider world. Blockchain technology owes its existence to this fundamental breakthrough.

A blockchain account is a key pair tuple (PK, SK). The PK or public key can be safely displayed anywhere and serves as a unique identifier of an otherwise anonymous user on the blockchain. 

Sometimes a public key is accompanied by a chain-specific prefix like “0x” or “erd,” which can make it incompatible with other chains, even if they use the same encryption algorithm. 

Private keys are used to sign transactions and must be kept secret from anyone except the account owner. A private key falling into the wrong hand will result in asset theft or other malicious activity on the chain. 

Using so-called elliptic curve cryptography, one can derive an unlimited number of public keys from a single private key. Still, it’s impossible to recreate a private key based on a public key – at least within a reasonable amount of time and using today’s technology. There is a possibility that quantum computers of the future will be able to reverse-engineer private keys, but this should not become a practical concern for at least a few more years. 

Quigon validators use blockchain key pairs to participate in the multisig process and submit their signatures to bridge smart contracts on target chains. The exact signature algorithm varies: most EVM-compatible chains use ECDSA (Elliptic Curve Digital Signature Algorithm), namely the secp256k1 curve for back compatibility with Bitcoin. Non-EVM chains like Elrond, Algorand, Solana, and Cardano use the Edwards Curve (Ed25519) algorithm. Ontology is EVM-compatible and uses ECDSA, but with the NIST P-256 curve.

**BFT tolerance and multisignature**

A distributed system should function even when some of its members (nodes) become unavailable or start behaving maliciously – in other words; it should be fault-tolerant. The term ‘Byzantine Fault Tolerance’ comes from a 1982 paper entitled “The Byzantine Generals Problem’. It describes a group of generals who have to arrive at a consensus decision by sending messengers to each other. However, some generals and messengers can be traitors and pass on false messages to sabotage the enterprise. The solution is to send more messengers than necessary so that the whole army can still function if some agents become unreliable.
Replicating the messenger analogy, in Quigon, a group of physically separated validators comprises the validator pool to avoid a single point of failure. For a transaction to be acknowledged as valid, a BFT threshold of ⅔ + 1 signature must be collected. The signature collection takes place in the QuiChain protected by the blockchain’s validators. At least 67% of the validators must sign a proposed transaction to succeed. 

Thanks to the BFT consensus, up to ⅓ of the validators can act maliciously or be down without any damage to the bridge functionality since the smart contracts will ignore them. System consensus will still be reached even if 33% of the validators are down or attempt to act maliciously. It makes the system resistant to the notorious 51% or even 66% attacks.

While the high availability of the validators is crucial for the bridge to work smoothly, sometimes validator nodes will go offline or lag. It can happen due to network congestion, cloud server maintenance, etc. There will be a threshold of downtime tolerance, but excessive downtime will be penalized – just like intentional misbehavior, such as double signing or signing transactions that other validators don’t confirm.

**Network, Endpoint & Cloud Security requirements for the bridge validators**

Since validators are composed of multiple components hosted on remote physical or virtual servers, they need a secure way to communicate with the bridged blockchains. The required validator cloud server settings are as follows:

1. Validators must be hosted behind a proxy firewall with a minimum possible number of whitelisted IP addresses.
2. Ports for accessing the instances must not be assigned common port numbers like 22, 80, or 443. Unusual high-numbered ports should be used to make them more difficult to detect using port scanners.
3. All communications are TLS 1.2 or TLS 1.3-encrypted, whereas, in TLS v 1.2, only secure cipher suites are allowed. Backward compatibility with TLS v 1.1 and 1.0, as well as SSL and certificate downgrading, are not supported.
4. DoS & DDoS protection rate limit is imposed, and excessively inquisitive IPs are blacklisted.
5. Validator endpoints are set up to resist all relevant OWASP vulnerabilities such as directory listing, directory traversal, source code disclosure, security misconfiguration, insecure deserialization of incoming data, etc.
6. Endpoint operating systems should have at least 99% uptime and the latest security patches with no default configurations.
7. No weak authentication mechanisms are allowed. 2FA must be implemented on all employee accounts that access the validators.
8. Incidents are logged and reported to the Quigon team and the entity controlling the corresponding validator.
9. Endpoint vulnerability scans are executed daily.

**Perimeter security**

The physical security of a facility is often overlooked, yet it’s a common attack vector. For example, even if a computer that contains crucial digital assets is kept unplugged from the internet, a nefarious agent can penetrate the room and infect the device with a virus stored on a USB drive. Alternatively, attackers can bribe an employee to steal or infect files, and so forth. 

Quigon created a so-called zero-trust DMZ (exclusion zone) to prevent physical penetration attacks. Apart from fingerprint entry control, employees will access only those data, equipment, and software required to do their job. The ‘exclusion zone’ will prevent employees from unintentionally or deliberately infecting the systems with spyware or exposing sensitive data. The zero-trust strategy makes phishing or social engineering attacks against random company employees less effective, if useful at all.

**Data Security and the human factor**

Quigon will never request, store, or access sensitive user data: mnemonics (seed phrase) and private keys. These will always be stored on user devices. The private key is needed for bridged blockchain wallets to sign user-initiated transactions. At the same time, mnemonics (usually a set of 12-14 words) is used to restore an account or attach it to a new wallet. Bridge transactions are signed directly from wallets, such as Metamask, ElrondWallet, etc., and never by the bridge.

As noted above, it is the user’s responsibility to securely manage the private key (PK), which also applies to Quigon employees and everyone involved with the bridge infrastructure. In 95% of cyber breaches, a human error is involved, such as exposing a private key due to phishing or a social engineering attack. Therefore, proper key management, including key back-ups and protection with other defense tools, is critical for controlling the human factor risks.

People involved in bridge interactions can be broadly divided into several categories, for each of which we’ve implemented different security protocols depending on the level of access and, therefore, the potential impact on the system.


|Consciousness of behavior|Insider|Outsider|
|:--:|:--|:--|
|Intended|Infiltrated (BHH)<br></br>Unsatisfied employee|Black-hat hacker (BHH)<br></br>Amateur (Script Kiddie)|
|By negligence|Careless or tricked employee|Careless or tricked blockchain user|

**Human Risk mitigation**

||Insider|Outsider|
|:--:|:--|:--|
|Intended|Zero-trust access control even in the DMZ,<br></br>Access limited to necessity|Firewalls, IP whitelists, unusually high port numbers|
|By negligence|Corporate Security Policies<br></br>Corporate Security Awareness|User Security Policies<br></br>User Security Awareness|

**A summary of vulnerabilities and mitigation solutions**

Assets affected by the risk:|	Action causing|	Attack / Failure|	Mitigation
|:---:|:---:|:---:|:---:|
|Confidentiality breach||
People: users, team, validators|	Exposure of sensitive information, e.g. private key or seed phrase|	Phishing attack, social engineering, negligence	|Awareness (blogs, UI notifications) & training (docs)
Critical data|	a) mnemonics, <br/>b) private keys - compromised	|XSS, MIM attack	|I/O TLS encrypted, obligatory 2FA whenever possible, physical ledgers
|Integrity breach|
User Property (NFTs)|	a) duplicated <br/>b) stolen <br/>c) lost	|Smart contract or smart contract language vulnerability exploited	|Audits by major security firms, pentests, bug bounty programs
Facilities|	NFT metadata storage unavailable|	Information deleted by the storage owner, hardware failure|	NFT metadata back-up or storage migration
|Availability breach|
Bridge services stopped|	a) validators are down <br/>b) blockchain nodes are down|	DoS, DDoS, OWASP attacks|	Incident recovery, continuous monitoring, firewalls & WAFs DDoS protection, 33% fault tolerance, node duplication + 1 in reserve, sharding



**Competitive Advantages**

Compared to all the bridging solutions described above, Quigon has several important advantages:
1. The first bridge designed exclusively for NFTs, tackling every aspect of asset transition and compatibility across multiple protocols;
2. A much wider range of supported blockchains: any chain can be connected to the bridge;
3. Linking EVM to a range of non-EVM chains with fundamentally different tech stacks, such as Elrond, Solana, Cardano, Algorand, etc.
4. A simple and seamless UI for minting, transferring, and exploring NFTs;
5. Attractively low transaction fees, payable in the currency of the origin blockchain (ETH, BNB, SOL, etc.);
6. Highly scalable: the capacity of the bridge is limited only by the TPS of the bridged chains;
7. Possibility to mint NFTs on multiple chains from an easy-to-use UI;
8. Superior security and reliability: a multilayer security system capable of preventing all common types of attacks, with no single point of failure;
9. A more versatile technological stack and provide the same level of security and reliability;
10. Possibly integrating the bridge with any NFT dApp, allowing users to trade and exchange NFTs the way they are used to, while the bridge operates behind the scenes.
11. Support of ERC-721 & ERC-11 NFT standards.
12. NFT smart contract logic transfer across standards and smart contract languages.
